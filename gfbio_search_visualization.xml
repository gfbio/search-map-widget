<?xml version="1.0" encoding="UTF-8" ?>
<Module>
	<ModulePrefs title="Search Visualization" author="Database Research Group of Uni Marburg">
		<Require feature="pubsub-2">
			<Param name="topics">
                <![CDATA[
				<Topic title="GFBio Listener" name="gfbio.search.selectedData.listener"
                	   description="Listens to GFBio Search data" type="string" subscribe="true" />
                ]]>
			</Param>
		</Require>
	</ModulePrefs>
	<Content type="html" preferred_height="300">
	<![CDATA[
        <script type="text/javascript">
            var iframe = undefined;

            function receiveVisualizationRequest(topic, data, subscriberData) {
                console.log(topic, data, subscriberData);

                var contentWindow = iframe[0].contentWindow;

                contentWindow.postMessage(data, '*');
            }

            gadgets.HubSettings.onConnect = function(hub, suc, err) {
                gadgets.Hub.subscribe('gfbio.search.selectedData', receiveVisualizationRequest);
            };

            (function() {
                iframe = document.createElement('iframe');
                iframe.id = 'searchVisualizationFrame';
                iframe.src = 'http://pc12388.mathematik.uni-marburg.de/search_widget/gfbio_search_visualization.html';
                iframe.style.border = 'none';
                iframe.style.margin = 0;
                iframe.style.padding = 0;
                iframe.style.height = '100%';
                iframe.style.width = '100%';
                document.getElementsByTagName('body')[0].appendChild(iframe);
            })();
        </script>
	]]>
	</Content>
</Module>